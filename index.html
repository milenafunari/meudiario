<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ğŸ“˜ DiÃ¡rio de Humor</title>
  <style>
  /* Reset bÃ¡sico */
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f8f9fa;
    color: #333;
    line-height: 1.6;
    padding: 2rem;
  }

  h1 {
    text-align: center;
    color: #5e35b1;
    font-size: 2rem;
    margin-bottom: 0.5rem;
  }

  p {
    text-align: center;
    color: #666;
    font-size: 1rem;
    margin-bottom: 2rem;
  }

  form {
    background: #fff;
    padding: 2rem;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.05);
    max-width: 700px;
    margin: auto;
    border-top: 4px solid #ba68c8;
  }

  label {
    display: block;
    margin-top: 1rem;
    font-weight: 600;
    color: #555;
  }

  input[type="text"],
  textarea,
  select {
    width: 100%;
    padding: 0.6rem 1rem;
    margin-top: 0.3rem;
    border-radius: 8px;
    border: 1px solid #ccc;
    resize: vertical;
    font-size: 1rem;
    transition: border-color 0.3s ease;
  }

  input[type="text"]:focus,
  textarea:focus,
  select:focus {
    outline: none;
    border-color: #7e57c2;
    box-shadow: 0 0 0 3px rgba(126, 87, 194, 0.2);
  }

  button {
    margin-top: 1.5rem;
    padding: 0.6rem 1.2rem;
    background-color: #7e57c2;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: bold;
    transition: background-color 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  button:hover {
    background-color: #673ab7;
  }

  .historico {
    margin-top: 3rem;
    max-width: 700px;
    margin-left: auto;
    margin-right: auto;
  }

  .registro {
    background: #fff;
    padding: 1.5rem;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    margin-bottom: 1.5rem;
    border-left: 5px solid #ce93d8;
    transition: transform 0.2s ease;
  }

  .registro:hover {
    transform: translateX(3px);
  }

  .registro strong {
    color: #4a148c;
    display: inline-block;
    margin-top: 0.3rem;
    font-size: 0.95rem;
  }

  .registro small {
    color: #888;
    font-size: 0.85rem;
  }

  @media (max-width: 600px) {
    form, .registro {
      padding: 1rem;
    }
  }
  </style>
</head>
<body>

  <h1>ğŸ“˜ DiÃ¡rio de Humor</h1>
  <p style="text-align:center;">Registre seu dia com leveza e reestruture pensamentos usando tÃ©cnicas da TCC.</p>

  <form id="diarioForm">
    
    <label for="data">ğŸ“… Data</label>
    <input type="date" id="data" name="data" required />

    <label for="situacao">ğŸ’­ SituaÃ§Ã£o do dia</label>
    <textarea id="situacao" name="situacao" rows="3" placeholder="Descreva brevemente o que aconteceu..."></textarea>

    <label for="pensamento">ğŸ§  Pensamento automÃ¡tico</label>
    <textarea id="pensamento" name="pensamento" rows="3" placeholder="O que veio Ã  mente automaticamente?"></textarea>

    <label for="reestruturacao">ğŸ” ReestruturaÃ§Ã£o cognitiva</label>
    <textarea id="reestruturacao" name="reestruturacao" rows="3" placeholder="Como vocÃª vÃª a situaÃ§Ã£o agora, de forma mais realista ou leve?"></textarea>

    <label for="humor">ğŸ˜„ Humor do dia</label>
    <select id="humor" name="humor">
      <option value="">Selecione...</option>
      <option value="ğŸ˜‚ Muito bom">ğŸ˜‚ Muito bom</option>
      <option value="ğŸ™‚ Bom">ğŸ™‚ Bom</option>
      <option value="ğŸ˜ Neutro">ğŸ˜ Neutro</option>
      <option value="ğŸ˜¢ Ruim">ğŸ˜¢ Ruim</option>
      <option value="ğŸ˜¡ Muito ruim">ğŸ˜¡ Muito ruim</option>
    </select>

    <label for="energia">âš¡ NÃ­vel de energia</label>
    <select id="energia" name="energia">
      <option value="">Selecione...</option>
      <option value="Baixa ğŸŒ">Baixa ğŸŒ</option>
      <option value="MÃ©dia ğŸ¦¥">MÃ©dia ğŸ¦¥</option>
      <option value="Alta ğŸ">Alta ğŸ</option>
    </select>

    <label for="sono">ğŸ˜´ Sono da noite anterior</label>
    <select id="sono" name="sono">
      <option value="">Selecione...</option>
      <option value="Pouco ğŸ’¤">Pouco ğŸ’¤</option>
      <option value="Normal ğŸ˜´">Normal ğŸ˜´</option>
      <option value="Demais ğŸ›Œ">Demais ğŸ›Œ</option>
    </select>

    <label for="medicacao">ğŸ’Š Tomou medicaÃ§Ã£o?</label>
    <select id="medicacao" name="medicacao">
      <option value="">Selecione...</option>
      <option value="Tomei tudo âœ…">Tomei tudo âœ…</option>
      <option value="Esqueci alguma âŒ">Esqueci alguma âŒ</option>
      <option value="NÃ£o tomei hoje">NÃ£o tomei hoje</option>
    </select>

    <label for="gatilho">ğŸ§¨ Gatilho emocional do dia</label>
    <select id="gatilho" name="gatilho">
      <option value="">Selecione...</option>
      <option value="Estresse">Estresse</option>
      <option value="Festa/fim de semana">Festa/fim de semana</option>
      <option value="DiscussÃ£o">DiscussÃ£o</option>
      <option value="Nada especÃ­fico">Nada especÃ­fico</option>
      <option value="Outro">Outro</option>
    </select>

    <label for="observacao">ğŸ“ ObservaÃ§Ã£o final (opcional)</label>
    <textarea id="observacao" name="observacao" rows="3" placeholder="Alguma coisa que quer lembrar? Ou uma piada sua sobre o dia..."></textarea>

    <button type="submit">ğŸ’¾ Registrar meu dia</button>
    <button type="button" onclick="exportarRegistros()">ğŸ“¥ Exportar Registros (.json)</button>
    <button type="button" onclick="exportarPDF()">ğŸ“„ Exportar como PDF</button>
  </form>

  <!-- Ãrea de histÃ³rico -->
  <div class="historico" id="historico">
    <h2>ğŸ•’ HistÃ³rico de Registros</h2>
    <p><small>Os registros sÃ£o salvos localmente no seu navegador.</small></p>
  </div>

  <!-- Biblioteca jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js "></script>

  <script>
    async function exportarPDF() {
  const { jsPDF } = window.jspdf;
  const registros = JSON.parse(localStorage.getItem("diarioHumor")) || [];

  if (registros.length === 0) {
    alert("VocÃª nÃ£o tem registros para exportar.");
    return;
  }

  const doc = new jsPDF();
  const pageWidth = doc.internal.pageSize.getWidth();
  const margin = 20;
  const maxWidth = pageWidth - margin * 2;

  // ConfiguraÃ§Ãµes iniciais
  doc.setFont("helvetica");
  doc.setFontSize(16);
  doc.setTextColor(50, 50, 50);

  // CabeÃ§alho
  doc.text("ğŸ“˜ DiÃ¡rio de Humor", margin, 20);
  doc.setFontSize(10);
  doc.setTextColor(100, 100, 100);
  doc.text("Registros baseados em Terapia Cognitivo-Comportamental", margin, 27);

  let y = 40;

  registros.forEach((reg, i) => {
    if (i > 0) y += 10;
    if (y > 270) {
      doc.addPage();
      y = 30;
    }

    // TÃ­tulo do registro
    doc.setFontSize(12);
    doc.setTextColor(60, 60, 60);
    doc.text(`ğŸ“Œ Registro de ${reg.data}`, margin, y);

    y += 7;
    doc.setFontSize(10);
    doc.setTextColor(80, 80, 80);

    // FunÃ§Ã£o auxiliar para adicionar texto com quebra automÃ¡tica
    function addTextWithWrap(text, x, yStart) {
      const lines = doc.splitTextToSize(text, maxWidth);
      lines.forEach(line => {
        if (y > 280) {
          doc.addPage();
          y = 30;
        }
        doc.text(line, x, y);
        y += 7;
      });
    }

    // Adiciona cada campo com wrap
    addTextWithWrap(`ğŸ˜„ Humor do dia: ${reg.humor}`, margin + 5, y);
    addTextWithWrap(`ğŸ’­ SituaÃ§Ã£o: ${reg.situacao || "(nÃ£o informado)"}`, margin + 5, y);
    addTextWithWrap(`ğŸ§  Pensamento automÃ¡tico: ${reg.pensamento || "(nÃ£o informado)"}`, margin + 5, y);
    addTextWithWrap(`ğŸ” ReestruturaÃ§Ã£o: ${reg.reestruturacao || "(nÃ£o informado)"}`, margin + 5, y);
    addTextWithWrap(`âš¡ Energia: ${reg.energia} | ğŸ˜´ Sono: ${reg.sono} | ğŸ’Š MedicaÃ§Ã£o: ${reg.medicacao}`, margin + 5, y);
    addTextWithWrap(`ğŸ§¨ Gatilho: ${reg.gatilho}`, margin + 5, y);
    if (reg.observacao) {
      addTextWithWrap(`ğŸ“ ObservaÃ§Ã£o: ${reg.observacao}`, margin + 5, y);
    }

    y += 5;
  });

  doc.save("Diario_de_Humor.pdf");
}
  </script>

</body>
</html>
